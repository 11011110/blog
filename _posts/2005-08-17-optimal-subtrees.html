---
layout: post
title:  'Optimal subtrees'
date:   2005-08-17 14:58:00
tags:   [optimal subtrees, algorithms, parametric optimization, papers]
---
Josiah (aka <b><a href="http://chouyu_31.livejournal.com/"><img src="http://stat.livejournal.com/img/userinfo.gif" alt="[info]" width="17" height="17" style="vertical-align: bottom; border: 0;" />chouyu_31</a></b>) has posted an update to our paper, now called <a href="http://arxiv.org/abs/cs.CG/0503023">The Weighted Maximum-Mean Subtree and Other Bicriterion Subtree Problems</a>.  As the new title implies, we can now solve a much broader class of optimal subtree problems, it connects more directly to the <a href="http://www.ics.uci.edu/~eppstein/pubs/param.html">parametric optimization</a> thread that&#x27;s been running through quite a few of my papers, and I think also that the writing is much improved.
<br />

<br />
I think it&#x27;s an interesting problem both theoretically and for its applications, which can be easily motivated in terms of optimizing return on investment in tree-structured decision processes, but you&#x27;ll have to read the paper for the details.  Instead, I wanted to briefly discuss an odd three-way complexity variation involving negative numbers in the title problem.  It&#x27;s sort of like what happens with shortest paths, where Dijkstra works for positive arc lengths, Bellman-Ford works but is slower for negative arc lengths but no negative cycle, and shortest simple paths are NP-complete when there may be negative cycles.
<br />

<br />
So, suppose you have a rooted tree, in which the nodes have both an investment cost and an eventual profit, both in dollars; you want to choose a subtree containing the root that maximizes the percentage return on investment, or equivalently the weighted average of the chosen nodes&#x27; profit/cost ratios, where each node&#x27;s ratio is weighted by its cost.  The result in the first version of the paper was that the subtree maximizing this weighted average can be found in linear time if the costs are all positive.  If some subtrees may have negative total cost, the problem is NP-complete via a straightforward reduction from subset sum, as we show in the new version of the paper.  But the main new result of the update is an algorithm that, when applied to this weighted average problem, allows individual nodes to have negative costs (that is, they pay you to invest in them rather than vice versa) as long as the total weight of any subtree containing the root is positive.  As with Bellman-Ford, this limited negativity slows us down but doesn&#x27;t stop us solving the problem: we have an O(<i>n</i> log <i>n</i>) algorithm.
<br />

<br />
Is the extra logarithmic factor necessary for the limited-negativity version of the problem?  I don&#x27;t know, but it is necessary for the parametric linear optimal subtree problem we use as the basis for our algorithm, since we have a reduction from sorting to it...
