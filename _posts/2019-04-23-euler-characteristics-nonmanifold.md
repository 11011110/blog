---
layout: post
title: Euler characteristics of non-manifold polycubes
date: 2019-04-23 16:37
---
From a $$2\times 2$$ block of cubes, remove two non-adjacent and non-opposite cubes. The resulting polycube has a boundary that is not a [manifold](https://en.wikipedia.org/wiki/Manifold): between the two removed cubes, there is an edge shared by four squares, but a two-dimensional manifold can only have two faces per edge. Nevertheless, we can compute its Euler characteristic as the number of vertices ($$25$$) minus the number of edges ($$47$$) plus the number of square faces ($$24$$). $$25-47+24=2$$, the same number we would expect for the Euler characteristic of a topological sphere! What does it mean?

{: style="text-align:center"}
![Removing two non-adjacent and non-opposite cubes from a 2x2 block of cubes]({{site.baseurl}}/assets/2019/nonmanifold-polycube.svg)

Any finite union of cubes of the integer lattice (not even necessarily connected) has as its boundary a set of vertices, edges, and squares, with each edge incident to an even number of squares. We can define the Euler characteristic to be the number of vertices minus edges plus squares, in the usual way. But we can also compute it in a different, more intrinsic and topological, way. For any $$\varepsilon$$ in the range $$0<\varepsilon<1/2$$, define the "shrunken interior" of the polycube to be the set of points of the interior farther than $$\varepsilon$$ from the boundary, and define the "shrunken exterior" in the same way. Then the shrunken interior and shrunken exterior both have (possibly disconnected) 2-manifolds as boundaries. We can define their Euler characteristics in the standard way from any cell decomposition of these boundaries (it doesn't matter which cell decomposition we choose). Then the Euler characteristic of the polycube is the average of the Euler characteristics of the shrunken interior and shrunken exterior!

In the case of the mutilated $$2\times 2$$ block, the shrunken interior and shrunken exterior are both topological balls (ignoring the puncture at infinity as it doesn't have a boundary), so the average of their Euler characteristics is the Euler characteristic of a sphere, as we calculated.

There's probably a simpler and more conceptual way of doing it, but here's an explanation for why the Euler characteristic of the polycube boundary is the average of the Euler characteristics of the interior and exterior. Form a cell complex on the boundary of the interior and exterior, together, in the following way: expand each square of the polycube boundary to a cuboid with thickness 0.1, expand each edge into a cylinder with diameter 0.2 (big enough to enclose all the intersections of two expanded squares), and expand each vertex into a sphere with diameter 0.3 (big enough to enclose all the intersections of two cylinders but small enough that no two of these spheres touch). Remove the union of these expanded shapes from the space, and consider what's left. It has the same topology as the union of the shrunken interior and exterior, and its boundary is now naturally divided up into cells: offset squares patches on the sides of each expanded square face, cylindrical patches on each expanded edge, and spherical patches on each expanded vertex, with curves where two patches meet.

Let's calculate the Euler characteristic of this cell complex. Each square of the polycube leads to two offset square patches, so the $$F$$ squares contribute  $$2F$$ to the Euler characteristic. Each edge $$e$$ of the polycube might be adjacent to two or four squares; call this number $$d(e)$$. Then the cylinder around $$e$$ includes $$d(e)$$ surface patches between pairs of squares and $$2d(e)$$ curves connecting them to the square patches. The patches count $$+1$$ and the curves count $$-1$$ for a total contribution to the Euler characteristic of $$-d(e)$$.

Finally, each vertex of the polycube becomes a sphere, subdivided by the patches and curves of the complex. These spheres also contain all the vertices of the complex. The Euler characteristic of a subdivided sphere would be $$2$$, but the vertex spheres have some parts of their subdivision removed. Where each edge cylinder or expanded square comes into the sphere, a patch of surfaces is removed, and the curves between these removed patches are also removed. An edge $$e$$ with degree $$d(e))$$ contributes to the removal of $$d(e)$$ curves and $$1+d(e)/2$$ patches (one for itself and $$1/2$$ for each adjacent square). So if there are $$V$$ vertices in the polycube, the $$2V$$ contribution from the Euler characteristics of the subdivided spheres is modified by subtracting $$1-d(e)/2$$ for each incident edge. The total modification at both endpoints of each edge is $$-2+d(e)$$. The $$d(e)$$ that we calculated here is cancelled by the $$-d(e)$$ on the cylinder for $$e$$, and we are left with a total modification of $$-2E$$ where $$E$$ is the number of polycube edges.

Putting all the pieces of this calculation together, the complex we have constructed on the union of the shrunken interior and exterior has Euler characteristic $$2V-2E+2F$$. Therefore, the Euler characteristic of the polycube boundary itself, $$V-E+F$$, equals the average of the characteristics of the interior and exterior. The same reasoning shows more generally that whenever you have a finite cell complex embedded into $$\mathbb{R}^3$$, dividing space up into chambers, the Euler characteristic of the complex equals half the sum of Euler characteristics of the manifolds bounding shrunken chambers.

Although Euler characteristics of 2-manifolds embedded without boundary in $$\mathbb{R}^3$$ are always even, this averaging method can produce non-manifold surfaces with odd Euler characteristic. For instance, consider mutilating the $$2\times 2$$ block in a different way, by removing two opposite cubes. The interior and exterior of the resulting polycube are both connected, but the interior is a solid torus and the exterior is a ball. So the Euler characteristic of the polycube should be the average of the torus and sphere, $$1$$. And if we actually calculate it we get $$25-48+24=1$$.

As this example shows, it's possible for a polycube to have different topologies of surface on the interior and exterior, and it's also possible to have different numbers of surfaces: for instance, two cubes attached vertex-to-vertex produce two interior surfaces but only one exterior. For cell complexes in $$\mathbb{R}^3$$, there appears to be no restriction on which combinations of surfaces are possible. But for cell complexes in other spaces (other 3-manifolds than Euclidean space) it may be possible to embed 2-manifolds with odd Euler characteristic. When this happens, the number of odd chambers of a cell complex must always be even. For, the parity of the sum of the Euler characteristics of the chambers must be even, in order to be able to divide by two and get an integer as the Euler characteristic of the cell complex.

([Discuss on Mastodon](https://mathstodon.xyz/@11011110/101978143052398446))