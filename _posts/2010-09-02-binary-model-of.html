---
layout: post
title:  'A binary model of cycle 3-coloring'
date:   2010-09-02 20:19:00
tags:   [color, graph theory]
---
<p>3-colorings of graphs are inherently a ternary thing, right? There are three choices for the color of each vertex. But, for 3-colorings of cycles, there's a way of looking at them in binary (as strings of bits) that may, I think, help simplify my still-unresolved <a href="http://cstheory.stackexchange.com/questions/777/rapidly-mixing-markov-chains-on-3-colorings-of-a-cycle">TCSexchange question</a> on random walks in the space of 3-colorings.</p>

<p>Fix a starting vertex of the cycle, and an orientation of the cycle. We'll assume that the three colors in a coloring are represented by the three numbers 0, 1, and 2 (mod 3). From any proper coloring of an <i>n</i>-cycle, generate a sequence of <i>n</i> bits by walking around the cycle clockwise from the starting vertex and writing down a 1 bit whenever the color at a vertex differs from the color at the previous vertex by +1 (mod 3), and writing down a 0 bit whenever the color at a vertex differs from the color at the previous vertex by -1 (mod 3). If a sequence of bits can be generated from a coloring in this way, let's call it a "colorful sequence".</p>

<p>It's not hard to see that a bit sequence is colorful if and only if the number of 1 bits and the number of 0 bits are equal to each other mod 3, because then the total difference as one goes around the cycle from the starting vertex back to itself is 0 mod 3. For instance, for <i>n</i> = 5, there are ten colorful sequences: 10000, 01000, 00100, 00010, 00001, 01111, 10111, 11011, 11101, and 11110. For large <i>n</i> very close to 1/3 of the possible bit sequences are colorful: the number of 1-bits is nearly equally likely to be any of the three values mod 3, but only one of these three values leads to colorful sequences. On the other hand, each colorful sequence encodes exactly three different colorings, because adding the same number (mod 3) to the colors of all the vertices produces another valid coloring with the same bit sequence. These two factors of 1/3 and 3 cancel, explaining the fact that the <a href="http://www.research.att.com/~njas/sequences/A092297">number of 3-colorings of an <i>n</i>-cycle</a> is very close to 2<sup>n</sup>.</p>

<p>A colorful sequence of length <i>n</i> can be formed from a colorful sequence of length <i>n</i> − 2 by adding 01 or 10 to the end, or it can be formed from a colorful sequence of length <i>n</i> − 1 by flipping and repeating the final bit. Therefore, the number of colorful sequences of length <i>n</i> obey the same <a href="http://en.wikipedia.org/wiki/Recurrence_relation">recurrence relation</a> <i>J</i><sub><i>n</i></sub> = <i>J</i><sub><i>n</i> − 1</sub> + 2<i>J</i><sub><i>n</i> − 2</sub> that defines the <a href="http://en.wikipedia.org/wiki/Jacobsthal_number">Jacobsthal numbers</a>, but with different initial conditions causing these numbers to be two times the Jacobsthal numbers, shifted over by one position.</p>

<p>A step in the Glauber dynamics (recoloring a single vertex of the cycle) looks, in this more abstract model of colorings, exactly like an operation that swaps the values of two cyclically adjacent bits. In my TCSexchange question, I originally wrote that Glauber steps don't work for <i>n</i> = 5 (based on the picture of the space of colorings of the 5-cycle that I included in <a href="{{site.baseurl}}{% post_url 2010-08-30-chessboards-and-colorings %}">my previous post</a>, which shows it breaking down into two 15-cycles if you remove the non-Glauber moves), and I quickly amended that to add that it also doesn't work for cycle lengths that are a multiple of three (based on the coloring that repeats the same three colors around the cycle, from which no moves are possible). But in fact this analysis shows that Glauber moves are almost never enough, because they always preserve the number of 0- and 1-bits in the bitstring representing the coloring but there exist different colorings with different numbers of 0- and 1-bits. The only exception is the 4-cycle, for which Glauber dynamics does work and for which all colorings use two 0-bits and two 1-bits.</p>

<p>If we take one step up from the Glauber moves, and look at the moves that change the colors of two adjacent vertices in the graph, then in the bitstring view of the world these moves take three cyclically adjacent bits with the same value and flip them: 000 ↔ 111. It seems obvious to me (though I know so little about techniques for proving rapid mixing that I don't know how to prove it) that these two kinds of moves, swapping two adjacent symbols and flipping three, are sufficient for rapid mixing on the set of colorful sequences, and it actually is obvious that they are sufficient to get from any colorful sequence to any other colorful sequence. For instance, on the five- and six-cycles, the state spaces they generate are shown below.</p>

<p style="text-align:center"><img src="http://www.ics.uci.edu/~eppstein/0xDE/c5-swap-3xflip.png" /></p>

<p style="text-align:center"><img src="http://www.ics.uci.edu/~eppstein/0xDE/c6-swap-3xflip.png" /></p>

<p>Proving rapid mixing on the set of colorful sequences isn't quite enough to prove rapid mixing on the set of 3-colorings: it's conceivable (though it seems unlikely to me) that there's a subset <i>S</i> of 1/3 of the colorings with the property that the colorful sequences map 1-1 to <i>S</i> and that it's very difficult to get from <i>S</i> to its complement. But it could be useful as a toy problem to test out ideas that will eventually solve <a href="http://cstheory.stackexchange.com/questions/777/rapidly-mixing-markov-chains-on-3-colorings-of-a-cycle">the real one</a> as well.</p>
